<div class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <div class="container mx-auto p-4 max-w-7xl">
        <div class="grid gap-8 md:grid-cols-2 mb-8">
            

            <!-- Student Profile -->
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
                <div class="flex items-center space-x-5">
                    <!-- Avatar Container -->
                    <div class="w-20 h-20 relative">
                        <!-- Profile Image -->
                        <img id="attendanceProfilePic" src="" alt="Profile Picture" class="w-full h-full rounded-full shadow-lg">
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800 dark:text-teal-400" id="attendanceStudentName"></h2>
                        <p class="text-sm text-gray-600 dark:text-gray-400" >Student ID: <span id="attendanceStudentId"></span></p>
                        <p class="text-sm text-gray-600 dark:text-gray-400" >Grade: <span id="attendanceStudentGrade"></span></p>
                    </div>
                </div>
                <!-- Action Buttons -->
                <div class="w-full sm:w-auto flex gap-4">
                    <button class="w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-teal-600 to-blue-500 text-white rounded-lg shadow-md hover:from-teal-500 hover:to-blue-400 transition-all text-sm font-medium focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <i class="fas fa-user-edit mr-2"></i> Export Data
                    </button>
                </div>
            </div>


            <!-- Filters Section -->
<div class="flex flex-col sm:flex-row gap-4 mt-6 p-5 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
    <select id="attendanceYearSelect" class="w-full sm:w-48 px-4 py-2.5 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-teal-500 text-sm text-gray-800 dark:text-gray-200 transition-all">
        <option value="">ð Select Academic Year</option>
    </select>
    <select id="attendanceTermSelect" class="w-full sm:w-48 px-4 py-2.5 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-teal-500 text-sm text-gray-800 dark:text-gray-200 transition-all">
        <option value="">ð Select Term</option>
    </select>
</div>

            

            <!-- Current Term -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-gray-200 dark:border-gray-700">
                <h2 class="text-2xl font-bold text-primary dark:text-primary mb-4">Current Term & Month</h2>
                <div class="grid gap-4">


                    <!-- School Term &-->
<div class="w-full flex flex-col gap-6 sm:gap-8 p-4 sm:p-6 bg-gray-100 dark:bg-gray-900 rounded-lg shadow-md">
    <!-- School Term & Month Info -->
    <div class="flex flex-col sm:flex-row sm:items-center justify-between">
        <div>
            <p class="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-200">Spring Term 2025</p>
            <p class="text-sm text-gray-600 dark:text-gray-400">February</p>
        </div>
        <div id="monthCompletion" class="text-sm text-gray-500 dark:text-gray-400 mt-2 sm:mt-0">60% of Month completed</div>
    </div>

    <!-- Term Progress Bar -->
    <div class="relative w-full bg-gray-300 dark:bg-gray-700 rounded-full h-3 sm:h-4 overflow-hidden">
        <div class="bg-gradient-to-r from-teal-500 to-blue-500 dark:from-teal-400 dark:to-blue-400 h-full rounded-full transition-all duration-500 ease-in-out" style="width: 60%"></div>
        <span class="absolute right-2 top-0 text-xs sm:text-sm text-gray-700 dark:text-gray-300">60%</span>
    </div>

    <!-- Attendance Section -->
    <div class="flex flex-col sm:flex-row gap-6">
<!-- Progress Section -->
<div class="w-full sm:w-1/2 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md flex flex-col items-center justify-center">
    <p class="text-sm font-semibold text-gray-500 dark:text-gray-400 mb-2">Academic Progress</p>
    <div class="relative w-40 h-40 sm:w-44 sm:h-44">
        <canvas id="termProgressChart"></canvas>
    </div>
    <div class="mt-3 text-center space-y-1">
        <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-300">
            <span class="font-semibold text-teal-500 dark:text-teal-400" id="termProgressText">60%</span>
            Term Completed
        </p>
        <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-300">
            <span class="font-semibold text-blue-500 dark:text-blue-400" id="attendanceProgressText">95%</span>
            Attendance Rate
        </p>
    </div>
</div>

        <!-- Attendance Breakdown -->
        <div class="w-full sm:w-1/2 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md">
            <p class="text-sm font-semibold text-gray-500 dark:text-gray-400 mb-2">Attendance Breakdown</p>
            <div class="space-y-2">
                <div class="flex justify-between text-xs sm:text-sm">
                    <span class="text-gray-600 dark:text-gray-400">Present</span>
                    <span class="font-medium text-green-500 dark:text-green-400">90%</span>
                </div>
                <div class="relative w-full bg-gray-300 dark:bg-gray-700 rounded-full h-2 sm:h-3">
                    <div class="bg-green-500 dark:bg-green-400 h-full rounded-full transition-all duration-500 ease-in-out" style="width: 90%"></div>
                </div>

                <div class="flex justify-between text-xs sm:text-sm">
                    <span class="text-gray-600 dark:text-gray-400">Absent</span>
                    <span class="font-medium text-red-500 dark:text-red-400">5%</span>
                </div>
                <div class="relative w-full bg-gray-300 dark:bg-gray-700 rounded-full h-2 sm:h-3">
                    <div class="bg-red-500 dark:bg-red-400 h-full rounded-full transition-all duration-500 ease-in-out" style="width: 5%"></div>
                </div>

                <div class="flex justify-between text-xs sm:text-sm">
                    <span class="text-gray-600 dark:text-gray-400">Late</span>
                    <span class="font-medium text-yellow-500 dark:text-yellow-400">5%</span>
                </div>
                <div class="relative w-full bg-gray-300 dark:bg-gray-700 rounded-full h-2 sm:h-3">
                    <div class="bg-yellow-500 dark:bg-yellow-400 h-full rounded-full transition-all duration-500 ease-in-out" style="width: 5%"></div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="relative bg-white dark:bg-gray-800 rounded-lg p-6 flex flex-col items-center text-center transition-all duration-300 hover:shadow-2xl shadow-lg shadow-gray-300 dark:shadow-gray-900">
    <!-- Circular Progress Background -->
    <div class="relative w-24 h-24">
        <svg class="w-full h-full transform -rotate-90" viewBox="0 0 100 100" fill="none">
            <!-- Background Circle -->
            <circle cx="50" cy="50" r="40" stroke="rgba(0,0,0,0.1)" stroke-width="8"></circle>
            <!-- Animated Progress Circle -->
            <circle cx="50" cy="50" r="40" stroke="url(#streakGradient)" stroke-width="8" stroke-dasharray="251.2" stroke-dashoffset="calc(251.2 - (var(--progress) * 251.2))" stroke-linecap="round"></circle>
            <defs>
                <linearGradient id="streakGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" stop-color="#14b8a6"></stop>
                    <stop offset="100%" stop-color="#0f766e"></stop>
                </linearGradient>
            </defs>
        </svg>
        <!-- Streak Number -->
        <span class="absolute inset-0 flex items-center justify-center text-4xl font-extrabold text-green-500" id="currentStreak">0</span>
    </div>
    <p class="text-gray-600 dark:text-gray-400 text-lg mt-2">Days Streak</p>
</div>

    <!-- Attendance Summary -->
    <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mt-6">
        <div class="p-4 rounded-lg bg-teal-100 text-teal-700 dark:bg-teal-900 dark:text-teal-100 flex flex-col items-center transition-transform transform hover:scale-105">
            <p class="text-sm font-semibold">Present</p>
            <p class="text-3xl font-bold">18</p>
            <p class="text-xs mt-1">+3 this week</p>
        </div>
        <div class="p-4 rounded-lg bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-100 flex flex-col items-center transition-transform transform hover:scale-105">
            <p class="text-sm font-semibold">Absent</p>
            <p class="text-3xl font-bold">2</p>
            <p class="text-xs mt-1">+1 this week</p>
        </div>
        <div class="p-4 rounded-lg bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-100 flex flex-col items-center transition-transform transform hover:scale-105">
            <p class="text-sm font-semibold">Late</p>
            <p class="text-3xl font-bold">1</p>
            <p class="text-xs mt-1">None this week</p>
        </div>
        <div class="p-4 rounded-lg bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-100 flex flex-col items-center transition-transform transform hover:scale-105">
            <p class="text-sm font-semibold">Events</p>
            <p class="text-3xl font-bold">3</p>
            <p class="text-xs mt-1">2 upcoming</p>
        </div>
    </div>

    <!-- Upcoming Events Section -->
    <div id="attendanceEvent" class="mt-6 bg-gray-100 dark:bg-gray-900 p-4 rounded-lg flex items-center gap-3 text-gray-600 dark:text-gray-400 transition-all hover:bg-gray-200 dark:hover:bg-gray-800">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-teal-500 dark:text-teal-300" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
        </svg>
        <span class="text-sm font-medium">Upcoming: <span class="font-semibold text-gray-800 dark:text-white">Spring Break (March 15-22)</span></span>
    </div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
            <div class="border-b border-gray-200 dark:border-gray-700">
                <div class="flex flex-wrap gap-2 px-6 pt-4">
                    <button data-tab="overview" class="a-tab-button px-4 py-3 rounded-t-lg text-sm font-medium transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 text-teal-600 dark:text-teal-400 border-b-2 border-teal-500" data-tab="attendanceSectionOverview">Overview</button>
                    <button data-tab="subjects" class="a-tab-button px-4 py-3 rounded-t-lg text-sm font-medium transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-teal-600 dark:hover:text-teal-300" data-tab="attendanceSectionWeekly">Weekly Log</button>
                    <button data-tab="progress" class="a-tab-button px-4 py-3 rounded-t-lg text-sm font-medium transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-teal-600 dark:hover:text-teal-300" data-tab="attendanceSectiontimetravel">Time Travel</button>
                    <button data-tab="feedback" class="a-tab-button px-4 py-3 rounded-t-lg text-sm font-medium transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-teal-600 dark:hover:text-teal-300" data-tab="attendanceSectionAnalysis">Analysis</button>
                </div>
            </div>

            <div id="attendanceSectionOverview" class="tab-content bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
                <div class="container mx-auto p-4">
                    <h3 class="text-lg font-semibold mb-4">Student Attendance Calendar</h3>
                  <!-- Calendar Section -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-4">
                        <div class="flex justify-between items-center mb-4">
                            <button id="prevMonth" class="p-2 bg-blue-500 text-white rounded">&lt;</button>
                            <h2 id="currentMonthYear" class="text-xl font-bold"></h2>
                            <button id="nextMonth" class="p-2 bg-blue-500 text-white rounded">&gt;</button>
                        </div>
                        <div id="calendar" class="grid grid-cols-7 gap-2"></div>
                    </div>

                    <!-- Top Students Section -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                        <h3 class="text-lg font-semibold mb-4">Top5 Punctuality Student</h3>
                        <div id="topStudents" class="space-y-4"></div>
                    </div>
                </div>

                <!-- Attendance Popup -->
                <div id="popupOverlay" class="fixed inset-0 bg-black bg-opacity-50 hidden"></div>
                <div id="attendancePopup" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg hidden">
                    <h3 id="popupDate" class="text-lg font-bold mb-2"></h3>
                    <p id="popupStatus"></p>
                    <p id="popupTimeIn"></p>
                    <p id="popupTimeOut"></p>
                    <button onclick="closePopup()" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">Close</button>
                </div>
            </div>

            <div id="attendanceSectionWeekly" class="tab-content hidden bg-gray-100 dark:bg-gray-900 p-6 rounded-lg">
                <h3 class="text-xl font-bold text-primary dark:text-primary mb-4">Weekly Attendance Log</h3>
                <table class="w-full">
                    <thead>
                        <tr>
                            <th class="text-left py-2">Day</th>
                            <th class="text-left py-2">Status</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>

            

            <div id="attendanceSectiontimetravel" class="tab-content bg-gray-100 dark:bg-gray-800 rounded-lg shadow-md p-6 hidden">
                        <h3 class="text-xl font-bold text-primary dark:text-primary mb-4">Time-Travel Calendar</h3>
                        <div class="flex gap-4 mb-4">
                            <select id="attendanceTimetravelYear" class="bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2">
                            </select>
                            <select id="attendanceTimetravelTerm" class="bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2">
                            </select>
                        </div>
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                            <!-- Calendar Header -->
                            <div class="flex justify-between items-center mb-4">
                                <h2 class="text-xl font-semibold text-gray-800 dark:text-gray-200">Attendance Calendar</h2>
                                <button class="bg-primary text-white px-4 py-2 rounded-lg text-sm shadow hover:bg-primary-dark transition">
                                    Download Report
                                </button>
                            </div>
                        
                            <!-- Responsive Scrollable Calendar Container -->
                            <div id="calendar_basic" 
                                 class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8 
                                        overflow-y-auto max-h-[500px] md:max-h-none p-4">
                            </div>
                        </div>
                        
                        <!-- Attendance Summary -->
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div class="bg-green-50 dark:bg-green-900 border-green-200 dark:border-green-700 border rounded-lg p-4">
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 dark:text-green-400 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                                    </svg>
                                    <h3 class="text-lg font-semibold text-green-700 dark:text-green-300">Present</h3>
                                </div>
                                <p class="text-3xl font-bold text-green-600 dark:text-green-400 mt-2" id="presentCount">0</p>
                                <p class="text-sm text-green-600 dark:text-green-400 mt-1">days</p>
                            </div>
                        
                            <div class="bg-red-50 dark:bg-red-900 border-red-200 dark:border-red-700 border rounded-lg p-4">
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500 dark:text-red-400 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                                    </svg>
                                    <h3 class="text-lg font-semibold text-red-700 dark:text-red-300">Absent</h3>
                                </div>
                                <p class="text-3xl font-bold text-red-600 dark:text-red-400 mt-2" id="absentCount">0</p>
                                <p class="text-sm text-red-600 dark:text-red-400 mt-1">days</p>
                            </div>
                        
                            <div class="bg-yellow-50 dark:bg-yellow-900 border-yellow-200 dark:border-yellow-700 border rounded-lg p-4">
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-500 dark:text-yellow-400 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
                                    </svg>
                                    <h3 class="text-lg font-semibold text-yellow-700 dark:text-yellow-300">Late</h3>
                                </div>
                                <p class="text-3xl font-bold text-yellow-600 dark:text-yellow-400 mt-2" id="lateCount">0</p>
                                <p class="text-sm text-yellow-600 dark:text-yellow-400 mt-1">days</p>
                            </div>
                        </div>
            </div>

            <div id="attendanceSectionAnalysis" class="tab-content hidden bg-gray-100 dark:bg-gray-900 p-6 rounded-lg">
    <h3 class="text-xl font-bold text-primary dark:text-primary mb-6">Attendance Analysis</h3>

    <!-- Timeframe Selector -->
    <div class="flex flex-wrap items-center justify-between bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md mb-6">
        <label for="timeframe" class="text-gray-700 dark:text-gray-300 font-semibold mr-2">View:</label>
        <select id="timeframe" class="bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary transition">
            <option value="weekly">Weekly</option>
            <option value="monthly">Monthly</option>
        </select>
    </div>

    <!-- Attendance Chart Card -->
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md mb-6">
        <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">Attendance</h4>
        <div style="height: 300px;">
            <canvas id="weeklyattendanceChart"></canvas>
        </div>
    </div>

    <!-- Punctuality Chart Card -->
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md">
        <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">Punctuality Rate</h4>
        <div style="height: 300px;">
            <canvas id="weeklypunctualityChart"></canvas>
        </div>
    </div>
</div>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/student/attendance.js') }}" defer></script>
</div>

